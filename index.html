<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>교통사고 합의금 시뮬레이터</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
</head>

<body>
    <div class="container">
        <div class="header">
            <h1>교통사고 합의금 시뮬레이터</h1>
            <p>2023년 개정 약관 기반 예상 합의금 및 치료 전략 분석</p>
        </div>

        <!-- Input Section -->
        <div class="input-section">
            <div class="form-row">
                <div class="form-group">
                    <label>사고 유형</label>
                    <select id="accidentType" class="form-control">
                        <option value="car_car">차대차 사고</option>
                        <option value="car_person">차대 보행자/이륜차</option>
                        <option value="passenger">동승자</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>상해 급수</label>
                    <select id="injuryGrade" class="form-control">
                        <option value="minor">경상 (12~14급)</option>
                        <option value="serious">중상 (11급 이상)</option>
                    </select>
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label>본인 과실 (%)</label>
                    <input type="number" id="faultRatio" class="form-control" value="0" min="0" max="100">
                </div>
                <div class="form-group">
                    <label>상대방 보험</label>
                    <select id="opponentInsurance" class="form-control">
                        <option value="comprehensive">종합보험</option>
                        <option value="liability">책임보험 (대인I)</option>
                    </select>
                </div>
            </div>

            <!-- Conditional: User Insurance (Show if Fault > 0) -->
            <div id="userInsuranceSection" class="form-group hidden animate-in">
                <label>내 보험 가입 형태 (과실 상계용)</label>
                <select id="myInsurance" class="form-control">
                    <option value="none">미가입/모름</option>
                    <option value="jasang">자동차상해 (자상)</option>
                    <option value="jason">자기신체사고 (자손)</option>
                </select>
            </div>

            <!-- Conditional: Annual Premium (Show if Fault > 0) -->
            <div id="premiumSection" class="form-group hidden animate-in">
                <label>내 연간 자동차 보험료 (할증 계산용)</label>
                <input type="number" id="annualPremium" class="form-control" placeholder="예: 1000000" value="1000000">
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label>입원 일수</label>
                    <input type="number" id="hospitalDays" class="form-control" value="0" min="0">
                </div>
                <div class="form-group">
                    <label>통원 횟수</label>
                    <input type="number" id="outpatientVisits" class="form-control" value="0" min="0">
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label>1일 소득 (원) <button class="btn-small" onclick="applyDailyWage()">주부/학생/무직 (소득증빙
                            어려움)</button></label>
                    <input type="number" id="dailyIncome" class="form-control" value="70000">
                </div>
                <div class="form-group">
                    <label>향후 치료비 예상액 (원)
                        <button class="btn-tip" onclick="toggleTip()" title="협상 팁 보기">?</button>
                    </label>
                    <input type="number" id="futureTreatment" class="form-control" value="500000">
                </div>
            </div>

            <!-- Future Treatment Tip Section -->
            <div id="futureTreatmentTip" class="tip-box hidden animate-in">
                <h3>💡 향후치료비 협상 꿀팁</h3>
                <p><strong>향후치료비란?</strong> 합의 이후에 발생할 것으로 예상되는 치료비를 미리 당겨서 받는 금액입니다. 정해진 공식이 없어 <strong>가장 유연하게 협상할 수
                        있는 항목</strong>입니다.</p>

                <div class="tip-content">
                    <h4>협상 전략:</h4>
                    <ul>
                        <li><strong>구체적인 치료 계획 제시:</strong> "아직 통증이 심해 3주 이상 물리치료와 약침 치료가 더 필요하다"고 구체적으로 어필하세요.</li>
                        <li><strong>고가 검사/치료 언급:</strong> "통증이 지속되면 MRI 촬영이나 추나요법을 받을 예정이다"라고 하면, 보험사는 이를 방어하기 위해 합의금을
                            높일 수 있습니다.</li>
                        <li><strong>심리적 우위:</strong> "지금 합의 안 하고 치료를 더 받겠다"는 태도는 보험사 입장에서 관리 비용 증가로 이어지므로 강력한 협상 카드가
                            됩니다.</li>
                    </ul>
                    <p class="tip-note">※ 통상적으로 경상 환자의 경우 30~50만원에서 시작하여, 협상 능력에 따라 100만원 이상으로 책정되기도 합니다.</p>
                </div>
            </div>

            <button onclick="calculateSettlement()" class="btn-calc">합의금 계산하기</button>
        </div>

        <!-- Result Section -->
        <div class="result-section">
            <div class="total-display">
                <div class="total-label">예상 총 합의금</div>
                <div class="total-amount" id="totalAmount">0원</div>
            </div>

            <div class="breakdown-list">
                <div class="breakdown-item">
                    <span>위로금</span>
                    <span id="consolationMoney">0원</span>
                </div>
                <div class="breakdown-item">
                    <span>휴업손해</span>
                    <span id="lostIncome">0원</span>
                </div>
                <div class="breakdown-item">
                    <span>통원교통비</span>
                    <span id="transportCost">0원</span>
                </div>
                <div class="breakdown-item">
                    <span>향후치료비</span>
                    <span id="futureCost">0원</span>
                </div>
                <div class="breakdown-item" style="color: var(--danger-color); display: none;" id="faultDeductionRow">
                    <span>과실 상계 (차감)</span>
                    <span id="faultDeduction">0원</span>
                </div>
            </div>

            <div id="surchargeSection" class="surcharge-box hidden">
                <div class="surcharge-title">
                    <span>⚠️ 보험료 할증 예상 (합의금 수령 시)</span>
                </div>
                <div class="surcharge-comparison">
                    <span>약 7% × 3년</span>
                    <span class="surcharge-value" id="surchargeAmount">0원</span>
                </div>
                <div style="font-size: 0.8rem; color: var(--text-muted); margin-top: 0.5rem;">
                    * 합의금과 할증액을 비교하여 보험 처리 여부를 결정하세요.
                </div>
            </div>

            <div id="adviceBox" class="advice-box">
                좌측 정보를 입력하고 계산하기를 눌러주세요.
            </div>

            <button onclick="saveResultImage()" class="btn-save hidden" id="btnSave">📸 결과 이미지로 저장하기</button>
        </div>
    </div>

    <script src="script.js"></script>
</body>

</html>