<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>교통사고 합의금 시뮬레이터</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
</head>

<body>
    <div class="container">
        <div class="header">
            <h1>🎄 교통사고 합의금 시뮬레이터 🎅</h1>
            <p>✨ 2023년 개정 약관 기반 | Christmas Edition ✨</p>
        </div>

        <!-- Input Section -->
        <div class="input-section">
            <div class="form-row">
                <div class="form-group">
                    <label>사고 유형</label>
                    <select id="accidentType" class="form-control">
                        <option value="car_car">차대차 사고</option>
                        <option value="car_person">차대 보행자/이륜차</option>
                        <option value="passenger">동승자</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>상해 급수</label>
                    <select id="injuryGrade" class="form-control">
                        <option value="minor">경상 (12~14급)</option>
                        <option value="serious">중상 (11급 이상 / 골절, 수술 등)</option>
                    </select>
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label>본인 과실 (%)</label>
                    <input type="number" id="faultRatio" class="form-control" value="0" min="0" max="100">
                    <div id="faultGuidance" class="guidance-text hidden"></div>
                </div>
                <div class="form-group">
                    <label>상대방 보험</label>
                    <select id="opponentInsurance" class="form-control">
                        <option value="comprehensive">종합보험</option>
                        <option value="liability">책임보험 (대인I)</option>
                    </select>
                </div>
            </div>

            <!-- Conditional: User Insurance (Show if Fault > 0) -->
            <div id="userInsuranceSection" class="form-group hidden animate-in">
                <label>내 보험 가입 형태 (과실 상계용)</label>
                <select id="myInsurance" class="form-control">
                    <option value="none">미가입/모름</option>
                    <option value="jasang">자동차상해 (자상)</option>
                    <option value="jason">자기신체사고 (자손)</option>
                </select>
            </div>

            <!-- Conditional: Annual Premium (Show if Fault > 0) -->
            <div id="premiumSection" class="form-group hidden animate-in">
                <label>내 연간 자동차 보험료 (할증 계산용)</label>
                <input type="number" id="annualPremium" class="form-control" placeholder="예: 1000000" value="1000000">
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label>입원 일수</label>
                    <input type="number" id="hospitalDays" class="form-control" value="0" min="0">
                </div>
                <div class="form-group">
                    <label>통원 횟수</label>
                    <input type="number" id="outpatientVisits" class="form-control" value="0" min="0">
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label>1일 소득 (원) <button class="btn-small" onclick="applyDailyWage()">주부/학생/무직 (소득증빙
                            어려움)</button></label>
                    <input type="number" id="dailyIncome" class="form-control" value="100000">
                </div>
                <div class="form-group">
                    <label>향후 치료비 예상액 (원)
                        <button class="btn-tip" onclick="toggleTip()" title="협상 팁 보기">?</button>
                    </label>
                    <input type="number" id="futureTreatment" class="form-control" value="500000">
                </div>
            </div>

            <!-- Future Treatment Tip Section -->
            <div id="futureTreatmentTip" class="tip-box hidden animate-in">
                <h3>💡 향후치료비 안내</h3>
                <p><strong>향후치료비란?</strong> 합의 이후에도 치료가 필요할 경우, 예상되는 치료비를 미리 산정하여 받는 금액입니다.</p>

                <div class="tip-content">
                    <h4>합의 시 참고사항:</h4>
                    <ul>
                        <li><strong>치료 계획 전달:</strong> 담당 의사에게 들은 치료 계획이나 예후를 보험사 담당자에게 그대로 전달하세요.</li>
                        <li><strong>추가 치료 가능성 언급:</strong> "의사 선생님께서 통증이 지속되면 MRI나 추가 치료가 필요할 수 있다고 하셨다"와 같이 의료진의 소견을
                            전달하세요.</li>
                        <li><strong>충분한 치료 후 합의:</strong> 급하게 합의하기보다, 치료가 어느 정도 마무리된 후 합의하면 더 정확한 금액을 산정할 수 있습니다.</li>
                    </ul>
                    <p class="tip-note">※ 향후치료비는 실제 치료 계획에 근거하여 청구하는 것이 원칙입니다. 정확한 보상을 위해 담당 의사와 충분히 상담 후 합의를 진행하세요.</p>
                </div>
            </div>

            <button onclick="calculateSettlement()" class="btn-calc">합의금 계산하기</button>
        </div>

        <!-- Result Section -->
        <div class="result-section">
            <div class="total-display">
                <div class="total-label">예상 총 합의금</div>
                <div class="total-amount" id="totalAmount">0원</div>
            </div>

            <div class="breakdown-list">
                <div class="breakdown-item">
                    <span>위로금</span>
                    <span id="consolationMoney">0원</span>
                </div>
                <div class="breakdown-item">
                    <span>휴업손해</span>
                    <span id="lostIncome">0원</span>
                </div>
                <div class="breakdown-item">
                    <span>통원교통비</span>
                    <span id="transportCost">0원</span>
                </div>
                <div class="breakdown-item">
                    <span>향후치료비</span>
                    <span id="futureCost">0원</span>
                </div>
                <div class="breakdown-item" style="color: var(--danger-color); display: none;" id="faultDeductionRow">
                    <span>과실 상계 (차감)</span>
                    <span id="faultDeduction">0원</span>
                </div>
            </div>

            <div id="surchargeSection" class="surcharge-box hidden">
                <div class="surcharge-title">
                    <span>⚠️ 보험료 할증 예상 (합의금 수령 시)</span>
                </div>
                <div class="surcharge-comparison">
                    <span>약 7% × 3년</span>
                    <span class="surcharge-value" id="surchargeAmount">0원</span>
                </div>
                <div style="font-size: 0.8rem; color: var(--text-muted); margin-top: 0.5rem;">
                    * 합의금과 할증액을 비교하여 보험 처리 여부를 결정하세요.
                </div>
            </div>

            <div id="adviceBox" class="advice-box">
                좌측 정보를 입력하고 계산하기를 눌러주세요.
            </div>

            <button onclick="saveResultImage()" class="btn-save hidden" id="btnSave">📸 결과 이미지로 저장하기</button>

            <div class="disclaimer">
                <strong>⚠️ 면책 조항 (Disclaimer)</strong><br>
                본 시뮬레이터의 결과는 사용자가 입력한 정보를 바탕으로 한 단순 예상치이며, 실제 합의금은 보험사 약관, 사고 정황, 의학적 소견 등에 따라 달라질 수 있습니다.<br>
                제공된 정보는 법률적 조언이 아니며, 본 결과에 대해 어떠한 법적 책임도 지지 않습니다. 정확한 보상 금액 산정 및 합의를 위해서는 손해사정사, 변호사 등 전문가와 상담하시기 바랍니다.
            </div>
        </div>

        <div class="footer">
            <div class="developer-info" onclick="openLogoModal()">
                <img src="logo_black_bg.png" alt="Han Predict Logo" class="developer-logo">
                <span>Developer: 한정우 | <a href="mailto:crazat@naver.com"
                        onclick="event.stopPropagation()">crazat@naver.com</a></span>
            </div>

            <p>개선사항이 있으면 말씀 부탁드립니다</p>
        </div>
    </div>

    <!-- Logo Modal -->
    <div id="logoModal" class="modal hidden" onclick="closeLogoModal()">
        <div class="modal-content" onclick="event.stopPropagation()">
            <span class="close-modal" onclick="closeLogoModal()">&times;</span>
            <img src="logo_clean.png" alt="Original Logo" class="modal-image">
        </div>
    </div>

    <script src="script.js"></script>
</body>

</html>